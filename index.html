<!-- car.html 详情页：读取 cars.json?id=xx · 图集切换 · 返回按钮 -->
<!doctype html>
<html lang="zh">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ONE MOTOR GROUP · Car Detail</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    .detail{max-width:960px;margin:0 auto;padding:18px}
    .back{display:inline-block;margin:10px 0 14px 0;padding:10px 12px;border:1px solid #735a13;border-radius:10px;background:#0b0a08;color:#e7d28b;font-weight:900}
    .gallery{position:relative;border-radius:16px;overflow:hidden;border:1px solid #6c5212}
    .gallery .big{width:100%;height:52vh;min-height:260px;background:#000 center/cover no-repeat}
    .thumbs{display:flex;gap:8px;overflow:auto;padding:8px;margin-top:8px}
    .thumbs img{height:64px;border-radius:10px;border:1px solid #6c5212;opacity:.85}
    .thumbs img.active{opacity:1;box-shadow:0 0 0 2px #d4af37}
    .infoBox{margin-top:14px;padding:14px;border:1px solid #6c5212;border-radius:14px;background:#0a0a0a}
    .infoBox h1{margin:0 0 8px 0;font-size:22px;font-weight:900}
    .infoBox .price{font-size:20px;font-weight:900;color:#ffdf85;margin-bottom:8px}
    .desc{opacity:.95;line-height:1.6;font-weight:700}
  </style>
</head>
<body>
  <div class="detail">
    <a class="back" href="index.html">← 返回 Back</a>
    <div class="gallery">
      <div id="big" class="big"></div>
      <div id="thumbs" class="thumbs"></div>
    </div>
    <div class="infoBox">
      <h1 id="name">Car</h1>
      <div id="price" class="price"></div>
      <div id="desc" class="desc"></div>
    </div>
  </div>

  <script>
    const params = new URLSearchParams(location.search);
    const id = params.get('id');

    (async ()=>{
      const r = await fetch('cars.json?cb=' + Date.now());
      let list = await r.json();
      list = list.map((c,i)=>({
        id: c.id || String(i+1),
        name: c.name || ('Vehicle #' + (i+1)),
        price: c.price || '',
        images: c.images || (c.image ? [c.image] : []),
        image: c.image || (c.images && c.images[0]) || '',
        desc: c.desc || {}
      }));
      const car = list.find(x=>x.id===id) || list[0];

      document.getElementById('name').textContent = car.name;
      document.getElementById('price').textContent = car.price;
      const desc = (car.desc && (car.desc.zh || car.desc.en || car.desc.bm)) || '';
      document.getElementById('desc').textContent = desc;

      const images = car.images.length ? car.images : (car.image ? [car.image] : []);
      const big = document.getElementById('big');
      const thumbs = document.getElementById('thumbs');

      function show(idx){
        big.style.backgroundImage = 'url("'+ images[idx] +'")';
        [...thumbs.children].forEach((img,i)=>img.classList.toggle('active', i===idx));
      }
      images.forEach((src,i)=>{
        const t = new Image();
        t.src = src; t.alt = 'photo';
        t.addEventListener('click', ()=>show(i));
        thumbs.appendChild(t);
      });
      show(0);
    })();
  </script>
</body>
</html>
